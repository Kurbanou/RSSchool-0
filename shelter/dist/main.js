(()=>{"use strict";const e={removeLoader(){setTimeout((()=>{document.querySelector(".page").classList.add("opacity-1"),document.querySelector(".loading").classList.add("opacity-0")}),500),setTimeout((()=>{document.querySelector(".loading").style.display="none"}),1e3)}},t={showPageUpIco(){const e=document.querySelector(".pageup");window.scrollY>100?(e.classList.remove("invisible"),setTimeout((()=>{document.querySelectorAll(".nav__link").forEach((e=>{e.classList.remove("nav_selected")})),document.querySelector(".nav__link_main").classList.add("nav_selected")}),500)):e.classList.add("invisible")}};class i{constructor({name:e,img:t,type:i,breed:a,description:s,age:n,inoculations:r,diseases:o,parasites:c}){this.name=e,this.img=t,this.type=i,this.breed=a,this.description=s,this.age=n,this.inoculations=r,this.diseases=o,this.parasites=c}generatePetCardMin(e){}generatePetCardMid(e,t="before"){const i=document.createElement("div");i.className="pet-card";const a=document.createElement("img");a.className="pet-card__img",a.setAttribute("src",`${this.img}`),a.setAttribute("alt",`${this.breed}`),i.append(a);const s=document.createElement("h4");s.classList="title title-h4",s.textContent=`${this.name}`,i.append(s);const n=document.createElement("button");n.classList="button pet-card__button",n.textContent="Learn more",i.append(n),"before"===t?e.prepend(i):e.append(i)}generatePetCardMax(e){}generateModalWindow(){const e=document.createElement("div");e.classList="modal-window invisible";const t=document.createElement("img");t.classList="modal-window__img",t.src=this.img,t.alt=this.breed,t.setAttribute("draggable",!1),e.append(t);const i=document.createElement("div");i.classList="modal-window__content",e.append(i);const a=document.createElement("div");a.classList="modal-window__content-header",i.append(a);const s=document.createElement("h3");s.classList="title title-h3 modal-window__title",s.textContent=this.name,a.append(s);const n=document.createElement("h4");n.classList="title title-h4 modal-window__subtitle",n.textContent=`${this.type} - ${this.breed}`,a.append(n);const r=document.createElement("h5");r.classList="title title-h4 modal-window__text",r.textContent=this.description,i.append(r);const o=document.createElement("ul");o.classList.add("modal-window__list"),i.append(o);const c=Object.keys(this).slice(5);for(let e=0;e<4;e++){const t=document.createElement("li");t.classList.add("modal-window__list-item"),t.textContent=`${c[e][0].toUpperCase()+c[e].slice(1)}:`;const i=document.createElement("span");i.classList.add("modal-window__span"),i.textContent=` ${this[c[e]]}`,t.append(i),o.append(t)}const l=document.createElement("div");l.classList.add("modal-window__close"),e.append(l);const d=document.createElement("div");d.classList.add("modal-window__cross"),l.append(d);const u=document.createElement("div");u.classList.add("modal-window__cross-line-1"),d.append(u);const m=document.createElement("div");m.classList.add("modal-window__cross-line-2"),d.append(m),l.addEventListener("click",this.closeModalWindow),document.querySelector(".page").prepend(e),setTimeout((()=>{e.classList.remove("invisible"),e.style.left="50%"}),0)}closeModalWindow(e){const t=document.querySelector(".modal-window");t.style.left="150%",s.showLayer(),setTimeout((()=>{t.remove()}),500)}}const a={carousel:document.querySelector(".carousel"),sliderClip:document.querySelector(".slider__clip"),frameClip:[[],[],[]],data:[],modalWindow:{},currentFramePackSize:0,resizeFramePackSize:0,framePackSize(){return window.innerWidth>1131?this.currentFramePackSize=3:window.innerWidth<1131&&window.innerWidth>767?this.currentFramePackSize=2:window.innerWidth<=767?this.currentFramePackSize=1:void 0},screenCheckSize(){window.innerWidth>1131&&(a.resizeFramePackSize=3),window.innerWidth<1131&&window.innerWidth>767&&(a.resizeFramePackSize=2),window.innerWidth<=767&&(a.resizeFramePackSize=1),a.resizeFramePackSize!==a.currentFramePackSize&&a.screenResize()},screenResize(){a.resizeFramePackSize>a.currentFramePackSize&&a.addFrames(this.data),a.resizeFramePackSize<a.currentFramePackSize&&a.removeFrames(this.data),this.framePackSize()},addFrames(e){for(let t=0;t<this.frameClip.length;t+=1){let i=this.randomInt(0,e.length-1);this.frameClip[t].includes(i)||this.frameClip[t-1]?.includes(i)||this.frameClip[t+1]?.includes(i)?t-=1:this.frameClip[t].push(i)}this.sliderClip.replaceChildren(),this.frameClip.flat().forEach((t=>{new i(e[t]).generatePetCardMid(this.sliderClip,"after")}))},removeFrames(){this.frameClip.forEach((e=>{e.pop(),this.sliderClip.removeChild(this.sliderClip.lastChild)}))},addCarouselEvents(e){this.data=e,this.carousel.addEventListener("click",this.clickSliderButton),this.sliderClip.addEventListener("animationend",this.sliderAnimationEnd),window.addEventListener("resize",this.screenCheckSize)},clickSliderButton(e){a.clickOnCarousel(e)},sliderAnimationEnd(e){"move-left"===e.animationName&&(a.sliderClip.classList.remove("transition-left"),a.getLeftFramePack(a.data),a.carousel.addEventListener("click",a.clickSliderButton)),"move-right"===e.animationName&&(a.sliderClip.classList.remove("transition-right"),a.getRightFramePack(a.data),a.carousel.addEventListener("click",a.clickSliderButton))},showPetCardModal(e){const t=this.data.find((t=>t.img===e));s.showLayer(),this.modalWindow=new i(t),this.modalWindow.generateModalWindow()},clickOnCarousel(e){e.target.classList.contains("pet-card")&&this.showPetCardModal(e.target.childNodes[0].attributes.src.nodeValue),e.target.parentElement.classList.contains("pet-card")&&this.showPetCardModal(e.target.parentNode.childNodes[0].attributes.src.nodeValue),e.target.classList.contains("carousel__btn_left")&&(this.sliderClip.classList.add("transition-left"),a.carousel.removeEventListener("click",a.clickSliderButton)),e.target.classList.contains("carousel__btn_right")&&(this.sliderClip.classList.add("transition-right"),a.carousel.removeEventListener("click",a.clickSliderButton))},randomInt:(e,t)=>Math.floor(Math.random()*(t-e+1)+e),getFrameClip(e){for(let t=0;t<this.frameClip.length;t+=1)for(let i=0;i<this.framePackSize();i+=1){let a=this.randomInt(0,e.length-1);this.frameClip[t].includes(a)||this.frameClip[t-1]?.includes(a)?i-=1:this.frameClip[t].push(a)}return this.frameClip},getRightFramePack(e){this.frameClip.shift(),this.frameClip.push([]);for(let t=0;t<this.framePackSize();t+=1){let a=this.randomInt(0,e.length-1);this.frameClip[2].includes(a)||this.frameClip[1].includes(a)?t-=1:(this.frameClip[2].push(a),new i(e[a]).generatePetCardMid(this.sliderClip,"after"),this.sliderClip.removeChild(this.sliderClip.firstChild))}},getLeftFramePack(e){this.frameClip.pop(),this.frameClip.unshift([]);for(let t=0;t<this.framePackSize();t+=1){let a=this.randomInt(0,e.length-1);this.frameClip[0].includes(a)||this.frameClip[1].includes(a)?t-=1:(this.frameClip[0].push(a),new i(e[a]).generatePetCardMid(this.sliderClip,"before"),this.sliderClip.removeChild(this.sliderClip.lastChild))}},fillFrameClip(e){this.getFrameClip(e).flat().forEach((t=>{new i(e[t]).generatePetCardMid(this.sliderClip,"after")}))},mouseScreen(){let e=null;this.carousel.addEventListener("mousedown",(function(t){a.sliderClip.setAttribute("mouseinframe","in"),e=t.screenX}),!1),this.carousel.addEventListener("mouseup",(function(t){let i=t.screenX;e-i>270?a.sliderClip.classList.add("transition-right"):i-e>270&&a.sliderClip.classList.add("transition-left"),a.sliderClip.setAttribute("mouseinframe","out")}),!1)},touchScreen(){let e=null;this.carousel.addEventListener("touchstart",(function(t){a.sliderClip.setAttribute("mouseinframe","in"),e=t.changedTouches[0].screenX}),!1),this.carousel.addEventListener("touchend",(function(t){let i=t.changedTouches[0].screenX;e-i>27?a.sliderClip.classList.add("transition-right"):i-e>27&&a.sliderClip.classList.add("transition-left"),a.sliderClip.setAttribute("mouseinframe","out")}),!1)}},s={layer:document.querySelector(".layer"),pageUpIco:document.querySelector(".pageup"),showLayer(){if(s.layer.classList.contains("layer_on")){if(s.layer.classList.remove("layer_on"),document.body.classList.remove("hide-scroll"),document.body.style.marginRight="0px",document.querySelector(".modal-window")){const e=document.querySelector(".modal-window");e.style.left="150%",setTimeout((()=>{e.remove()}),500)}window.scrollY>100&&this.showPageUpIco()}else s.layer.classList.add("layer_on"),document.body.classList.add("hide-scroll"),document.body.style.marginRight=`${this.getScrollWidth()}px`,window.scrollY>100&&(this.pageUpIco.classList.add("invisible"),this.pageUpIco.style.right="-100px")},showPageUpIco(){this.pageUpIco.style.right="30px",this.pageUpIco.classList.remove("invisible")},getScrollWidth(){let e=document.createElement("div");e.style.overflowY="scroll",e.style.width="50px",e.style.height="50px",document.body.append(e);let t=e.offsetWidth-e.clientWidth;return e.remove(),t}},n={menu:document.querySelector(".burger"),nav:document.querySelector(".nav"),modal:document.querySelector(".modal-window"),openBurgerMenu(){!n.menu.classList.contains("burger_opened")&&!s.layer.classList.contains("layer_on")&&window.innerWidth<768?(n.menu.classList.add("burger_opened"),n.nav.classList.add("nav_opened"),window.scrollTo(0,0),s.showLayer()):window.innerWidth>=768&&!document.body.classList.contains("hide-scroll")?window.scrollTo(0,0):(window.innerWidth>=768&&document.body.classList.contains("hide-scroll")||(n.menu.classList.remove("burger_opened"),n.nav.classList.remove("nav_opened")),s.showLayer())},link(e){const t=e.target.classList;t.contains("nav_selected")&&n.openBurgerMenu(),t.contains("nav__link")&&!t.contains("nav_selected")&&(document.querySelectorAll(".nav__link").forEach((e=>{e.classList.remove("nav_selected")})),t.add("nav_selected")),document.querySelector(".page").offsetWidth+s.getScrollWidth()<768&&e.target.hasAttribute("data-link")&&n.openBurgerMenu(),s.showPageUpIco()}},r={data:[],queue:[],modalWindow:{},pageNumber:1,cardsNumber:3,carousel:document.querySelector(".carousel"),sliderClip:document.querySelector(".slider-clip"),petsNavigation:document.querySelector(".pets-navigation"),paginationNumber:document.querySelector(".pagination-number"),pagMinRightBtn:document.querySelector(".pag-min-right"),pagMaxRightBtn:document.querySelector(".pag-max-right"),pagMinLeftBtn:document.querySelector(".pag-min-left"),pagMaxLeftBtn:document.querySelector(".pag-max-left"),getDataForPagination(e){this.data=e.map(((e,t,i)=>(e.img=".."+e.img.slice(5),e)));const t=[];for(let e=0;e<6;e+=1)t.push(this.data);this.data=t.flat()},getQueueForPagination(){let e=0;const t=[];for(;e<this.data.length/4;){const i=[];for(let s=0;s<4;s+=1){let n=a.randomInt(0,7);i.includes(n)||t[e-1]?.includes(n)?s-=1:i.push(n)}t.push(i),e+=1}this.queue=t.flat();const i=this.queue.map((e=>this.data[e].name));console.log(i)},getNumberOfCardsPerPage(){const e=window.innerWidth;return e<=1250&&e>640?6:e>1250?8:e<=640?3:void 0},addPaginationEvents(){this.touchScreen(),this.mouseScreen(),window.addEventListener("resize",this.resizeCardList),this.petsNavigation.addEventListener("click",this.clickOnPetsNavigation),this.carousel.addEventListener("click",this.clickOnPetsCard)},resizeCardList(e){const t=r.getNumberOfCardsPerPage();t>r.cardsNumber&&(6===t&&(r.pageNumber=Math.ceil(r.pageNumber/2),r.paginationNumber.textContent=r.pageNumber,r.createCardList(),r.cardsNumber=t),8===t&&(r.pageNumber=Math.ceil(r.pageNumber/1.5),r.paginationNumber.textContent=r.pageNumber,r.createCardList(),r.cardsNumber=t)),t<r.cardsNumber&&(6===t&&(r.pageNumber=Math.floor(r.pageNumber/3*4),r.paginationNumber.textContent=r.pageNumber,r.createCardList(),r.cardsNumber=t),3===t&&(r.pageNumber>1&&(r.pageNumber*=2),r.paginationNumber.textContent=r.pageNumber,r.createCardList(),r.cardsNumber=t))},clickOnPetsNavigation(e){e.target.classList.contains("pag-min-right")&&r.pagMinRight(),e.target.classList.contains("pag-max-right")&&r.pagMaxRight(),e.target.classList.contains("pag-min-left")&&r.pagMinLeft(),e.target.classList.contains("pag-max-left")&&r.pagMaxLeft(),r.checkNavButtons()},checkNavButtons(){1===this.pageNumber&&(this.pagMinLeftBtn.classList.add("inactive-arrow"),this.pagMaxLeftBtn.classList.add("inactive-arrow")),this.pageNumber>1&&(this.pagMinLeftBtn.classList.remove("inactive-arrow"),this.pagMaxLeftBtn.classList.remove("inactive-arrow")),this.pageNumber===Math.ceil(this.data.length/this.cardsNumber)&&(this.pagMinRightBtn.classList.add("inactive-arrow"),this.pagMaxRightBtn.classList.add("inactive-arrow")),this.pageNumber<Math.ceil(this.data.length/this.cardsNumber)&&(this.pagMinRightBtn.classList.remove("inactive-arrow"),this.pagMaxRightBtn.classList.remove("inactive-arrow"))},createCardList(){this.petsNavigation.removeEventListener("click",this.clickOnPetsNavigation),document.querySelector(".slider__clip").style.opacity=0,setTimeout((()=>{document.querySelectorAll(".pet-card").forEach((e=>e.remove()));for(let e=0;e<this.cardsNumber;e+=1)this.data[this.queue[(this.pageNumber-1)*this.cardsNumber+e]]&&new i(this.data[this.queue[(this.pageNumber-1)*this.cardsNumber+e]]).generatePetCardMid(document.querySelector(".slider__clip"),"after");document.querySelectorAll(".pet-card").length!==this.cardsNumber&&window.scrollTo(0,0),document.querySelector(".slider__clip").style.opacity=1,this.petsNavigation.addEventListener("click",this.clickOnPetsNavigation)}),300)},pagMinRight(){this.pageNumber*this.cardsNumber<this.queue.length&&(this.pageNumber+=1,this.paginationNumber.textContent=this.pageNumber,this.createCardList())},pagMinLeft(){this.pageNumber*this.cardsNumber>this.cardsNumber&&(this.pageNumber-=1,this.paginationNumber.textContent=this.pageNumber,this.createCardList())},pagMaxRight(){this.pageNumber=Math.ceil(this.data.length/this.cardsNumber),this.paginationNumber.textContent=this.pageNumber,this.createCardList()},pagMaxLeft(){this.pageNumber=1,this.paginationNumber.textContent=this.pageNumber,this.createCardList()},mouseScreen(){let e=null;this.carousel.addEventListener("mousedown",(function(t){a.sliderClip.setAttribute("mouseinframe","in"),e=t.screenX}),!1),this.carousel.addEventListener("mouseup",(function(t){let i=t.screenX;e-i>270?r.pagMinRight():i-e>270&&r.pagMinLeft(),a.sliderClip.setAttribute("mouseinframe","out"),r.checkNavButtons()}),!1)},touchScreen(){let e=null;this.carousel.addEventListener("touchstart",(function(t){a.sliderClip.setAttribute("mouseinframe","in"),e=t.changedTouches[0].screenX}),!1),this.carousel.addEventListener("touchend",(function(t){let i=t.changedTouches[0].screenX;e-i>27?r.pagMinRight():i-e>27&&r.pagMinLeft(),a.sliderClip.setAttribute("mouseinframe","out"),r.checkNavButtons()}),!1)},clickOnPetsCard(e){e.target.classList.contains("pet-card")&&r.showPetCardModal(e.target.childNodes[0].attributes.src.nodeValue),e.target.parentElement.classList.contains("pet-card")&&r.showPetCardModal(e.target.parentNode.childNodes[0].attributes.src.nodeValue)},showPetCardModal(e){const t=this.data.find((t=>t.img===e));s.showLayer(),this.modalWindow=new i(t),this.modalWindow.generateModalWindow()}};window.addEventListener("load",(e=>{(async e=>{const t=await fetch(e);return await t.json()})(document.querySelector(".pets-page")?"../data/data.json":"./src/data/data.json").then((e=>{o(e)}))}));const o=function(i){const o=window.location.pathname.split("/").pop();e.removeLoader(),window.addEventListener("scroll",t.showPageUpIco),n.menu.addEventListener("click",n.openBurgerMenu),s.layer.addEventListener("click",n.openBurgerMenu),n.nav.addEventListener("click",(e=>n.link(e))),document.addEventListener("keyup",(e=>{"Escape"===e.key&&n.openBurgerMenu()})),"index.html"===o?(a.fillFrameClip(i),a.addCarouselEvents(i),a.mouseScreen(),a.touchScreen()):(r.getDataForPagination(i),r.cardsNumber=r.getNumberOfCardsPerPage(),r.getQueueForPagination(),r.createCardList(),r.addPaginationEvents())};console.log("\nOценка за задание 110 баллов.\n\n##### Реализация burger menu на обеих страницах: +26\n\n- [x] при ширине страницы меньше 768рх панель навигации скрывается, появляется бургер-иконка: +2\n- [x] при нажатии на бургер-иконку, справа плавно появляется адаптивное меню шириной 320px, бургер-иконка плавно поворачивается на 90 градусов: +4\n- [x] высота адаптивного меню занимает всю высоту экрана: +2\n- [x] при повторном нажатии на бургер-иконку или на свободное от бургер-меню пространство (оба варианта должны быть реализованы) адаптивное меню плавно скрывается уезжая за правую часть экрана, бургер-иконка плавно поворачивается на 90 градусов обратно: +4\n- [x] бургер-иконка создана при помощи html+css, без использования изображений: +2\n- [x] ссылки в адаптивном меню работают, обеспечивая плавную прокрутку по якорям, сохраняются заданные на первом этапе выполнения задания требования интерактивности элементов меню: +2\n- [x] при клике по любой ссылке (интерактивной или неинтерактивной) в меню адаптивное меню плавно скрывается вправо, бургер-иконка поворачивается на 90 градусов обратно: +2\n- [x] расположение и размеры элементов в бургер-меню соответствует макету (центрирование по вертикали и горизонтали элементов меню, расположение иконки). При этом на странице Pets цветовая схема может быть как темная, так и светлая: +2\n- [x] область, свободная от бургер-меню, затемняется: +2\n- [x] страница под бургер-меню не прокручивается: +4\n\n##### Реализация слайдера-карусели на странице Main: +36\n\n- [x] при нажатии на стрелки происходит переход к новому блоку элементов: +4\n- [x] смена блоков происходит с соответствующей анимацией карусели (способ выполнения анимации не проверяется): +4\n- [x] слайдер бесконечен, т.е. можно бесконечно много нажимать влево или вправо, и каждый раз будет прокрутка в эту сторону с новым набором карточек: +4\n- [x] при переключении влево или вправо прокручивается ровно столько карточек, сколько показывается при текущей ширине экрана (3 для 1280px, 2 для 768px, 1 для 320px): +4\n- [x] каждый новый слайд содержит псевдослучайный набор карточек животных, т.е. формируется из исходных объектов в случайном порядке со следующими условиями:\n- [x] в текущем блоке слайда карточки с питомцами не повторяются: +4\n- [x] в следующем блоке нет дублирования карточек с текущим блоком. Например в слайдере из 3 элементов, следующий выезжающий слайд будет содержать 3 (из 8 доступных) новых карточки питомца, таких, каких не было среди 3х карточек на предыдущем уехавшем слайде: +4\n- [x] сохраняется только одно предыдущее состояние. Т.е. при последовательном переходе два раза влево, а потом два раза вправо, мы получим набор карточек, отличный от исходного: +4\n- [x] при каждой перезагрузке страницы формируется новая последовательность карточек: +2\n- [x] генерация наборов карточек происходит на основе 8 объектов с данными о животных: +2\n- [x] при изменении ширины экрана (от 1280px до 320px и обратно), слайдер перестраивается и работает без перезагрузки страницы (набор карточек при этом может как изменяться, так и оставаться тем же, скрывая лишнюю или добавляя недостающую, и сохраняя при этом описанные для слайдера требования): +4\n\n##### Реализация пагинации на странице Pets: +36\n\n- [x] при перезагрузке страницы всегда открывается первая страница пагинации: +2\n- [x] при нажатии кнопок > или < открывается следующая или предыдущая страница пагинации соответственно: +2\n- [x] при нажатии кнопок >> или << открывается последняя или первая страница пагинации соответственно: +2\n- [x] при открытии первой страницы кнопки << и < неактивны: +2\n- [x] при открытии последней страницы кнопки > и >> неактивны: +2\n- [x] в кружке по центру указан номер текущей страницы. При переключении страниц номер меняется на актуальный: +2\n- [x] каждая страница пагинации содержит псевдослучайный набор питомцев, т.е. формируется из исходных объектов в случайном порядке со следующими условиями:\n- [x] при загрузке страницы формируется массив из 48 объектов питомцев. Каждый из 8 питомцев должен встречаться ровно 6 раз: +4\n- [x] при каждой перезагрузке страницы формируется новый массив со случайной последовательностью: +4\n- [x] карточки питомцев не должны повторяться на одной странице: +4\n- [x] при переключении страницы данные меняются (для >1280px меняется порядок карточек, для остальных - меняется набор и порядок карточек): +4\n- [x] при неизменных размерах области пагинации, в том числе размерах окна браузера, и без перезагрузки страницы, возвращаясь на страницу под определенным номером, контент на ней всегда будет одинаков. Т.е. карточки питомцев будут в том же расположении, что и были до перехода на другие страницы: +2\n- [x] общее количество страниц при ширине экрана 1280px - 6, при 768px - 8, при 320px - 16 страниц: +2\n- [x] при изменении ширины экрана (от 1280px до 320px и обратно), пагинация перестраивается и работает без перезагрузки страницы (страница может оставаться той же или переключаться, при этом сформированный массив - общая последовательность карточек - не обновляется, сохраняются все остальные требования к пагинации): +4\n\n##### Реализация попап на обеих страницах: +12\n\n- [x] попап появляется при нажатии на любое место карточки с описанием конкретного животного: +2\n- [x] часть страницы вне попапа затемняется: +2\n- [x] при открытии попапа вертикальный скролл страницы становится неактивным, при закрытии - снова активным: +2\n- [x] при нажатии на область вокруг попапа или на кнопку с крестиком попап закрывается (оба варианта должны быть реализованы), при этом при нажатии на сам попап ничего не происходит: +2\n- [x] кнопка с крестиком интерактивная: +2\n- [x] окно попапа (не считая кнопку с крестиком) центрировано по всем осям, размеры элементов попапа и их расположение совпадают с макетом: +2\n")})();